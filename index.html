<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>English Coach â€” Instant English Feedback</title>
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64'%3E%3Crect rx='14' ry='14' width='64' height='64' fill='%237a3ff2'/%3E%3C/svg%3E">
  <link rel="stylesheet" href="./app.css" />
  <script defer src="./config.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js"></script>
  <script defer src="./app.js"></script>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <span class="logo"></span>
      <span>English Coach</span>
    </div>
    <nav class="topnav">
      <a id="feedbackLink" href="#" class="link">Feedback</a>
      <span id="userChip">Guest Â· <button id="btnSignIn" class="link">Sign in</button></span>
    </nav>
  </header>

  <main class="shell">
    <!-- LEFT: Goals + Recording + Starter prompt -->
    <aside class="leftcol">
      <section class="card">
        <h2>Record for <b>60â€“90 seconds</b>.</h2>
        <p>Weâ€™ll analyze fluency & correctness, then show key corrections and a next prompt.</p>
      </section>

      <section class="card">
        <h3>Goal</h3>
        <div id="goals" class="pillrow">
          <button class="pill active" data-goal="Work English">Work English</button>
          <button class="pill" data-goal="Daily Life">Daily Life</button>
          <button class="pill" data-goal="Interview Prep">Interview Prep</button>
          <button class="pill" data-goal="Travel">Travel</button>
          <button class="pill" data-goal="Presentation">Presentation</button>
        </div>
      </section>

      <section class="card">
        <h3>Recording</h3>
        <div class="row gap">
          <button id="btnStart" class="cta"><span class="play">â–¶</span> Start recording</button>
          <button id="btnStop" class="ghost" disabled>â–  Stop</button>
        </div>

        <div class="recwrap">
          <div id="timer" class="timer">00:00</div>
          <div class="meterwrap">
            <div id="meter" class="meter"></div>
          </div>
        </div>

        <div class="row gap">
          <button id="btnSend" class="wide" disabled>Send & Analyze</button>
          <span id="stateBadge" class="chip subtle">Idle</span>
        </div>
      </section>

      <section class="card">
        <h3>What to say to start</h3>
        <div id="prompt" class="promptbox">
          Describe a recent project you led and one lesson you learned.
        </div>
        <div class="row gap between">
          <button id="btnRnd" class="tiny"><span class="dice">ðŸŽ²</span> Randomize prompt</button>
          <span id="recStateMini" class="chip mini subtle">Idle</span>
        </div>
      </section>

      <section class="card minirow">
        <div class="mini">Level: <span id="levelLabel">â€“</span></div>
        <div class="mini">Fillers: <span id="fillers">0</span></div>
        <div class="mini">Sessions: <span id="sessions">0</span></div>
        <div class="mini">Streak: <span id="streak">0</span> ðŸ”¥</div>
      </section>
    </aside>

    <!-- RIGHT: Results -->
    <section class="rightcol card results">
      <div class="hdrrow">
        <div class="row badges">
          <span class="badge">Level: <b id="friendlyLevel">â€“</b></span>
          <span class="badge">Fillers: <b id="fillersTop">0</b></span>
          <span class="badge">Sessions: <b id="sessionsTop">0</b></span>
          <span class="badge">Streak: <b id="streakTop">0</b> ðŸ”¥</span>
        </div>
      </div>

      <h4>Pronunciation</h4>
      <div id="pronBox" class="listbox empty">â€“</div>

      <h4>Grammar</h4>
      <div id="gramBox" class="listbox empty">â€“</div>

      <h4>What to fix now</h4>
      <div id="fixBox" class="note">â€“</div>

      <h4>Next prompt (30â€“45s)</h4>
      <div id="nextBox" class="note">â€“</div>

      <h4>Leaderboard</h4>
      <div id="board" class="board">Public leaderboard requires sign-in. Youâ€™ll still see your local totals below.</div>
    </section>
  </main>

  <footer class="footer">
    <div>Â© 2025 <a href="https://simpleia.com" target="_blank" rel="noreferrer">Simpleia</a> â€” Built by <a href="https://aosama.net" target="_blank" rel="noreferrer">Abdo Osama</a></div>
    <div>v<span id="ver"></span></div>
  </footer>

  <!-- Feedback modal -->
  <dialog id="fbDialog" class="modal">
    <form method="dialog" class="modalcard" id="fbForm">
      <div class="modalhdr">Quick feedback (optional)</div>
      <div class="row2">
        <input id="fbName" type="text" placeholder="Your name" />
        <input id="fbEmail" type="email" placeholder="Email (optional)" />
      </div>

      <div class="stars" id="stars" aria-label="Rating">
        <input type="radio" name="rating" id="r5" value="5"><label for="r5">â˜…</label>
        <input type="radio" name="rating" id="r4" value="4"><label for="r4">â˜…</label>
        <input type="radio" name="rating" id="r3" value="3"><label for="r3">â˜…</label>
        <input type="radio" name="rating" id="r2" value="2"><label for="r2">â˜…</label>
        <input type="radio" name="rating" id="r1" value="1"><label for="r1">â˜…</label>
      </div>

      <textarea id="fbText" rows="5" placeholder="Any ideas to improve?"></textarea>

      <div class="row gap end">
        <button type="button" id="fbSkip" class="ghost">Skip</button>
        <button id="fbSend" class="cta">Submit feedback & Continue</button>
      </div>
    </form>
  </dialog>

  <!-- Auth modal -->
  <dialog id="authBox" class="modal">
    <div class="modalcard">
      <div class="modalhdr">Sign in to save your streak & appear on the leaderboard</div>
      <div class="row gap">
        <button id="btnMagic" class="ghost">Email link</button>
        <input id="authEmail" class="grow" type="email" placeholder="you@email.com" />
      </div>
      <div class="row gap">
        <button id="btnGoogle" class="cta ghost">Continue with Google</button>
        <button id="btnFacebook" class="ghost">Continue with Facebook</button>
      </div>
      <div class="row gap end">
        <button id="authClose" class="ghost">Close</button>
      </div>
    </div>
  </dialog>
</body>
</html>
